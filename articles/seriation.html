<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3. Seriation • tabula</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3. Seriation">
<meta property="og:description" content="">
<meta property="og:image" content="http://tabula.archaeo.science/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bibliography.html">5. Bibliography</a>
    </li>
    <li>
      <a href="../articles/dating.html">4. Dating Methods</a>
    </li>
    <li>
      <a href="../articles/diversity.html">2. Diversity Measures</a>
    </li>
    <li>
      <a href="../articles/matrix.html">1. Matrix Classes</a>
    </li>
    <li>
      <a href="../articles/seriation.html">3. Seriation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nfrerebeau/tabula">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>3. Seriation</h1>
                        <h4 class="author">N. Frerebeau</h4>
            
            <h4 class="date">2019-09-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nfrerebeau/tabula/blob/master/vignettes/seriation.Rmd"><code>vignettes/seriation.Rmd</code></a></small>
      <div class="hidden name"><code>seriation.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tabula)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(magrittr)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The matrix seriation problem in archaeology is based on three conditions and two assumptions, which <span class="citation">Dunnell (1970)</span> summarizes as follows.</p>
<p>The homogeneity conditions state that all the groups included in a seriation must:</p>
<ul>
<li>Be of comparable duration,</li>
<li>Belong to the same cultural tradition,</li>
<li>Come from the same local area.</li>
</ul>
<p>The mathematical assumptions state that the distribution of any historical or temporal class:</p>
<ul>
<li>Is continuous through time,</li>
<li>Exhibits the form of a unimodal curve.</li>
</ul>
<p>Theses assumptions create a distributional model and ordering is accomplished by arranging the matrix so that the class distributions approximate the required pattern. The resulting order is <em>inferred</em> to be chronological.</p>
</div>
<div id="reciprocal-ranking" class="section level1">
<h1 class="hasAnchor">
<a href="#reciprocal-ranking" class="anchor"></a>Reciprocal ranking</h1>
<p>Reciprocal ranking iteratively rearrange rows and/or columns according to their weighted rank in the data matrix until convergence <span class="citation">(Ihm 2005)</span>.</p>
<p>For a given incidence matrix <span class="math inline">\(C\)</span>:</p>
<ul>
<li>The rows of <span class="math inline">\(C\)</span> are rearranged in increasing order of:</li>
</ul>
<p><span class="math display">\[ x_{i} = \sum_{j = 1}^{p} j \frac{c_{ij}}{c_{i \cdot}} \]</span></p>
<ul>
<li>The columns of <span class="math inline">\(C\)</span> are rearranged in a similar way:</li>
</ul>
<p><span class="math display">\[ y_{j} = \sum_{i = 1}^{m} i \frac{c_{ij}}{c_{\cdot j}} \]</span></p>
<p>These two steps are repeated until convergence. Note that this procedure could enter into an infinite loop.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">## Build an incidence matrix with random data</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">incidence1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/IncidenceMatrix-class.html">IncidenceMatrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">400</span>, <span class="ot">TRUE</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)),</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                              <span class="dt">nrow =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">## Get seriation order on rows and columns</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">## If no convergence is reached before the maximum number of iterations (100), </a>
<a class="sourceLine" id="cb2-8" data-line-number="8">## it stops with a warning.</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">(indices &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate_reciprocal</a></span>(incidence1, <span class="dt">margin =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">stop =</span> <span class="dv">100</span>))</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; Permutation order for matrix seriation: </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;    Matrix ID: 9d05ee8e-8b3f-434c-9edb-d570c5d45597 </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;    Row order: 1 4 20 3 9 16 19 10 13 2 11 7 17 5 6 18 14 15 8 12 </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;    Column order: 1 16 9 4 8 14 3 20 13 2 6 18 7 17 5 11 19 12 15 10 </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt;    Method: reciprocal</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">## Permute matrix rows and columns</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">incidence2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(incidence1, indices)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">## Plot matrix</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="kw"><a href="../reference/plot_matrix.html">plot_heatmap</a></span>(incidence1) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Original matrix"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"TRUE"</span> =<span class="st"> "black"</span>, <span class="st">"FALSE"</span> =<span class="st"> "white"</span>))</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="kw"><a href="../reference/plot_matrix.html">plot_heatmap</a></span>(incidence2) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Rearranged matrix"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"TRUE"</span> =<span class="st"> "black"</span>, <span class="st">"FALSE"</span> =<span class="st"> "white"</span>))</a></code></pre></div>
<p><img src="seriation_files/figure-html/ranking-1.png" width="700"><img src="seriation_files/figure-html/ranking-2.png" width="700"></p>
<p>The positive difference from the column mean percentage (in french “écart positif au pourcentage moyen”, EPPM) represents a deviation from the situation of statistical independence <span class="citation">(Desachy 2004)</span>. As independence can be interpreted as the absence of relationships between types and the chronological order of the assemblages, EPPM is a useful graphical tool to explore significance of relationship between rows and columns related to seriation <span class="citation">(Desachy 2004)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">## Replicates Desachy 2004 results</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">## Coerce dataset to an abundance matrix</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">compiegne_counts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/coerce.html">as_count</a></span>(compiegne)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">## Plot original data matrix</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw"><a href="../reference/plot_bar.html">plot_ford</a></span>(compiegne_counts, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Original dataset"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">  </span>khroma<span class="op">::</span><span class="kw"><a href="http://khroma.archaeo.science/reference/scale_tol_discrete.html">scale_fill_bright</a></span>()</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">## Get seriation order for columns on EPPM using the reciprocal averaging method</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">## Expected column order: N, A, C, K, P, L, B, E, I, M, D, G, O, J, F, H</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">compiegne_indices &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate_reciprocal</a></span>(compiegne_counts, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>, <span class="dt">margin =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">## Permute columns</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">compiegne_seriation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(compiegne_counts, compiegne_indices)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17"></a>
<a class="sourceLine" id="cb3-18" data-line-number="18">## Plot new matrix</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="kw"><a href="../reference/plot_bar.html">plot_ford</a></span>(compiegne_seriation, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Reordered dataset"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="st">  </span>khroma<span class="op">::</span><span class="kw"><a href="http://khroma.archaeo.science/reference/scale_tol_discrete.html">scale_fill_bright</a></span>()</a></code></pre></div>
<p><img src="seriation_files/figure-html/averaging-1.png" width="672"><img src="seriation_files/figure-html/averaging-2.png" width="672"></p>
</div>
<div id="correspondence-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#correspondence-analysis" class="anchor"></a>correspondence analysis</h1>
<div id="seriation" class="section level2">
<h2 class="hasAnchor">
<a href="#seriation" class="anchor"></a>Seriation</h2>
<p>correspondence Analysis (CA) is an effective method for the seriation of archaeological assemblages. The order of the rows and columns is given by the coordinates along one dimension of the CA space, assumed to account for temporal variation. The direction of temporal change within the correspondence analysis space is arbitrary: additional information is needed to determine the actual order in time.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">## Coerce dataset to an abundance matrix</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">zuni_counts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/coerce.html">as_count</a></span>(zuni)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">## correspondence analysis of the whole dataset</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">corresp &lt;-<span class="st"> </span>ca<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ca/man/ca.html">ca</a></span>(zuni_counts)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">coords &lt;-<span class="st"> </span>ca<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ca/man/cacoord.html">cacoord</a></span>(corresp, <span class="dt">type =</span> <span class="st">"principal"</span>)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">## Plot CA results</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> Dim1, <span class="dt">y =</span> Dim2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(coords<span class="op">$</span>rows), <span class="dt">color =</span> <span class="st">"black"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(coords<span class="op">$</span>columns), <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</a></code></pre></div>
<p><img src="seriation_files/figure-html/ca-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">## Get row permutations from CA coordinates</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">zuni_indices &lt;-<span class="st"> </span>zuni_counts <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/seriation.html">seriate_correspondence</a></span>(<span class="dt">margin =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">## Permute data matrix</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">zuni_seriation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(zuni_counts, zuni_indices)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">## Plot Ford diagram</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">## Warning: this may take a few seconds!</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw"><a href="../reference/plot_bar.html">plot_ford</a></span>(zuni_seriation) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">                 <span class="dt">axis.ticks =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>())</a></code></pre></div>
<p><img src="seriation_files/figure-html/ca-seriation-1.png" width="672"></p>
</div>
<div id="refining" class="section level2">
<h2 class="hasAnchor">
<a href="#refining" class="anchor"></a>Refining</h2>
<p><span class="citation">Peeples and Schachner (2012)</span> propose a procedure to identify samples that are subject to sampling error or samples that have underlying structural relationships and might be influencing the ordering along the CA space. This relies on a partial bootstrap approach to CA-based seriation where each sample is replicated <code>n</code> times. The maximum dimension length of the convex hull around the sample point cloud allows to remove samples for a given <code>cutoff</code> value.</p>
<p>According to <span class="citation">Peeples and Schachner (2012)</span>, “[this] point removal procedure [results in] a reduced dataset where the position of individuals within the CA are highly stable and which produces an ordering consistend with the assumptions of frequency seriation.”</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">## Replicates Peeples and Schachner 2012 results</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">## Samples with convex hull maximum dimension length greater than the cutoff</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">## value will be marked for removal.</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">## Define cutoff as one standard deviation above the mean</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">fun &lt;-<span class="st"> </span><span class="cf">function</span>(x) { <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(x) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(x) }</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">## Get indices of samples to be kept</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">## Warning: this may take a few seconds!</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">(zuni_keep &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">refine_seriation</a></span>(zuni_counts, <span class="dt">cutoff =</span> fun, <span class="dt">n =</span> <span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; Partial bootstrap CA seriation refinement:</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; - Cutoff values: 2.22 (rows) - 0.37 (columns)</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; - Rows to keep: 349 of 420 (83%)</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; - Columns to keep: 14 of 18 (78%)</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"></a>
<a class="sourceLine" id="cb6-17" data-line-number="17">## Plot convex hull</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">## blue: convex hull for samples; red: convex hull for types</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">### All bootstrap samples</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">group =</span> id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"rows"</span>]], </a>
<a class="sourceLine" id="cb6-24" data-line-number="24">                        <span class="dt">fill =</span> <span class="st">"blue"</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"columns"</span>]], </a>
<a class="sourceLine" id="cb6-26" data-line-number="26">                        <span class="dt">fill =</span> <span class="st">"red"</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Whole dataset"</span>, <span class="dt">x =</span> <span class="st">"Dim. 1"</span>, <span class="dt">y =</span> <span class="st">"Dim. 2"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</a>
<a class="sourceLine" id="cb6-30" data-line-number="30">### Only retained samples</a>
<a class="sourceLine" id="cb6-31" data-line-number="31">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">group =</span> id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="dt">data =</span> <span class="kw"><a href="../reference/subset.html">subset</a></span>(zuni_keep[[<span class="st">"rows"</span>]], </a>
<a class="sourceLine" id="cb6-35" data-line-number="35">                                      id <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(zuni_keep[[<span class="st">"keep"</span>]][[<span class="dv">1</span>]])),</a>
<a class="sourceLine" id="cb6-36" data-line-number="36">                        <span class="dt">fill =</span> <span class="st">"blue"</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"columns"</span>]], </a>
<a class="sourceLine" id="cb6-38" data-line-number="38">                        <span class="dt">fill =</span> <span class="st">"red"</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Selected samples"</span>, <span class="dt">x =</span> <span class="st">"Dim. 1"</span>, <span class="dt">y =</span> <span class="st">"Dim. 2"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</a>
<a class="sourceLine" id="cb6-42" data-line-number="42"></a>
<a class="sourceLine" id="cb6-43" data-line-number="43">## Histogram of convex hull maximum dimension length</a>
<a class="sourceLine" id="cb6-44" data-line-number="44">hull_length &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span>(<span class="dt">length =</span> zuni_keep[[<span class="st">"lengths"</span>]][[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb6-45" data-line-number="45">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> hull_length, <span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> length)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="fl">4.5</span>, <span class="dt">by =</span> <span class="fl">0.5</span>), <span class="dt">fill =</span> <span class="st">"grey70"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="kw">fun</span>(hull_length<span class="op">$</span>length), <span class="dt">colour =</span> <span class="st">"red"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Convex hull max. dim."</span>, </a>
<a class="sourceLine" id="cb6-49" data-line-number="49">                <span class="dt">x =</span> <span class="st">"Maximum length"</span>, <span class="dt">y =</span> <span class="st">"Count"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</a></code></pre></div>
<p><img src="seriation_files/figure-html/refine-1.png" width="700"><img src="seriation_files/figure-html/refine-2.png" width="700"><img src="seriation_files/figure-html/refine-3.png" width="700"></p>
<p>If the results of <code>refine_seriation</code> is used as an input argument in <code>seriate</code>, a correspondence analysis is performed on the subset of <code>object</code> which matches the samples to be kept. Then excluded samples are projected onto the dimensions of the CA coordinate space using the row transition formulae. Finally, row coordinates onto the first dimension give the seriation order.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">## Get CA-based seriation order</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">(zuni_refined &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate_correspondence</a></span>(zuni_counts, zuni_keep, <span class="dt">margin =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; Permutation order for matrix seriation: </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    Matrix ID: 08de03f2-a5f5-49a9-8b37-6071d95e9dea </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;    Row order: 372 350 387 367 110 417 364 357 407 160 373 406 356 344 348 384 378 362 339 383... (400 more) </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;    Column order: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;    Method: refined correspondence</span></a></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-desachy2004">
<p>Desachy, Bruno. 2004. “Le sériographe EPPM : un outil informatisé de sériation graphique pour tableaux de comptages.” <em>Revue archéologique de Picardie</em> 3 (1): 39–56. <a href="https://doi.org/10.3406/pica.2004.2396" class="uri">https://doi.org/10.3406/pica.2004.2396</a>.</p>
</div>
<div id="ref-dunnell1970">
<p>Dunnell, Robert C. 1970. “Seriation Method and Its Evaluation.” <em>American Antiquity</em> 35 (03): 305–19. <a href="https://doi.org/10.2307/278341" class="uri">https://doi.org/10.2307/278341</a>.</p>
</div>
<div id="ref-ihm2005">
<p>Ihm, Peter. 2005. “A Contribution to the History of Seriation in Archaeology.” In <em>Classification the Ubiquitous Challenge</em>, edited by Claus Weihs and Wolfgang Gaul, 307–16. Berlin Heidelberg: Springer. <a href="https://doi.org/10.1007/3-540-28084-7_34" class="uri">https://doi.org/10.1007/3-540-28084-7_34</a>.</p>
</div>
<div id="ref-peeples2012">
<p>Peeples, Matthew A., and Gregson Schachner. 2012. “Refining Correspondence Analysis-Based Ceramic Seriation of Regional Data Sets.” <em>Journal of Archaeological Science</em> 39 (8): 2818–27. <a href="https://doi.org/10.1016/j.jas.2012.04.040" class="uri">https://doi.org/10.1016/j.jas.2012.04.040</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#reciprocal-ranking">Reciprocal ranking</a></li>
      <li>
<a href="#correspondence-analysis">correspondence analysis</a><ul class="nav nav-pills nav-stacked">
<li><a href="#seriation">Seriation</a></li>
      <li><a href="#refining">Refining</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicolas Frerebeau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
