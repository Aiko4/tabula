<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seriation and dating methods • tabula</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Seriation and dating methods">
<meta property="og:description" content="">
<meta property="og:image" content="http://tabula.archaeo.science/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabula</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bibliography.html">Bibliography</a>
    </li>
    <li>
      <a href="../articles/diversity.html">Diversity measures</a>
    </li>
    <li>
      <a href="../articles/matrix.html">Matrix classes</a>
    </li>
    <li>
      <a href="../articles/seriation.html">Seriation and dating methods</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nfrerebeau/tabula">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Seriation and dating methods</h1>
                        <h4 class="author">N. Frerebeau</h4>
            
            <h4 class="date">2019-09-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nfrerebeau/tabula/blob/master/vignettes/seriation.Rmd"><code>vignettes/seriation.Rmd</code></a></small>
      <div class="hidden name"><code>seriation.Rmd</code></div>

    </div>

    
    
<div id="seriation" class="section level1">
<h1 class="hasAnchor">
<a href="#seriation" class="anchor"></a>Seriation</h1>
<p>The matrix seriation problem in archaeology is based on three conditions and two assumptions, which <span class="citation">Dunnell (1970)</span> summarizes as follows.</p>
<p>The homogeneity conditions state that all the groups included in a seriation must:</p>
<ul>
<li>Be of comparable duration,</li>
<li>Belong to the same cultural tradition,</li>
<li>Come from the same local area.</li>
</ul>
<p>The mathematical assumptions state that the distribution of any historical or temporal class:</p>
<ul>
<li>Is continuous through time,</li>
<li>Exhibits the form of a unimodal curve.</li>
</ul>
<p>Theses assumptions create a distributional model and ordering is accomplished by arranging the matrix so that the class distributions approximate the required pattern. The resulting order is infered to be chronological.</p>
<div id="reciprocal-ranking" class="section level2">
<h2 class="hasAnchor">
<a href="#reciprocal-ranking" class="anchor"></a>Reciprocal ranking</h2>
<p>Reciprocal ranking iteratively rearrange rows and/or columns according to their weighted rank in the data matrix until convergence <span class="citation">(Ihm 2005)</span>.</p>
<p>For a given incidence matrix <span class="math inline">\(C\)</span>:</p>
<ul>
<li>The rows of <span class="math inline">\(C\)</span> are rearranged in increasing order of:</li>
</ul>
<p><span class="math display">\[ x_{i} = \sum_{j = 1}^{p} j \frac{c_{ij}}{c_{i \cdot}} \]</span></p>
<ul>
<li>The columns of <span class="math inline">\(C\)</span> are rearranged in a similar way:</li>
</ul>
<p><span class="math display">\[ y_{j} = \sum_{i = 1}^{m} i \frac{c_{ij}}{c_{\cdot j}} \]</span></p>
<p>These two steps are repeated until convergence. Note that this procedure could enter into an infinite loop.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Build an incidence matrix with random data</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">incidence1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/IncidenceMatrix-class.html">IncidenceMatrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">400</span>, <span class="ot">TRUE</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)),</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                              <span class="dt">nrow =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># Get seriation order on rows and columns</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># If no convergence is reached before the maximum number of iterations (100), </span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co"># it stops with a warning.</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">(indices &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate_reciprocal</a></span>(incidence1, <span class="dt">margin =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">stop =</span> <span class="dv">100</span>))</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; Permutation order for matrix seriation: </span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;    Matrix ID: 5211e33f-0211-4128-9bb7-a416b64bb956 </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt;    Row order: 1 4 20 3 9 16 19 10 13 2 11 7 17 5 6 18 14 15 8 12 </span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt;    Column order: 1 16 9 4 8 14 3 20 13 2 6 18 7 17 5 11 19 12 15 10 </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;    Method: reciprocal</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co"># Permute matrix rows and columns</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17">incidence2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(incidence1, indices)</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co"># Plot matrix</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="kw"><a href="../reference/plot_matrix.html">plot_heatmap</a></span>(incidence1) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Original matrix"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"TRUE"</span> =<span class="st"> "black"</span>, <span class="st">"FALSE"</span> =<span class="st"> "white"</span>))</a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="kw"><a href="../reference/plot_matrix.html">plot_heatmap</a></span>(incidence2) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Rearranged matrix"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"TRUE"</span> =<span class="st"> "black"</span>, <span class="st">"FALSE"</span> =<span class="st"> "white"</span>))</a></code></pre></div>
<p><img src="seriation_files/figure-html/ranking-1.png" width="700"><img src="seriation_files/figure-html/ranking-2.png" width="700"></p>
</div>
<div id="reciprocal-averaging" class="section level2">
<h2 class="hasAnchor">
<a href="#reciprocal-averaging" class="anchor"></a>Reciprocal averaging</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Reproduces Desachy 2004 results</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">## Coerce dataset to an abundance matrix</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">compiegne_counts &lt;-<span class="st"> </span><span class="kw">as</span>(compiegne, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">## Plot original data matrix</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="../reference/plot_bar.html">plot_ford</a></span>(compiegne_counts, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Original dataset"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">panel.spacing =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="dv">0</span>, <span class="st">"lines"</span>),</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">                 <span class="dt">panel.border =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(<span class="dt">colour =</span> <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">                 <span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">## Get seriation order for columns on EPPM using the reciprocal averaging method</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">## Expected column order: N, A, C, K, P, L, B, E, I, M, D, G, O, J, F, H</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">compiegne_indices &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate_reciprocal</a></span>(compiegne_counts, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>, <span class="dt">margin =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17"></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">## Permute columns</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">compiegne_seriation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(compiegne_counts, compiegne_indices)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">## Plot new matrix</a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="kw"><a href="../reference/plot_bar.html">plot_ford</a></span>(compiegne_seriation, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Reordered dataset"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">panel.spacing =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="dv">0</span>, <span class="st">"lines"</span>),</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">                 <span class="dt">panel.border =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(<span class="dt">colour =</span> <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">                 <span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="seriation_files/figure-html/averaging-1.png" width="672"><img src="seriation_files/figure-html/averaging-2.png" width="672"></p>
</div>
<div id="correspondance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#correspondance-analysis" class="anchor"></a>Correspondance analysis</h2>
<p>Correspondance Analysis (CA) is an effective method for the seriation of archaeological assemblages. The order of the rows and columns is given by the coordinates along one dimension of the CA space, assumed to account for temporal variation. The direction of temporal change within the correspondance analysis space is arbitrary: additional information is needed to determine the actual order in time.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">## Coerce dataset to an abundance matrix</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">zuni_counts &lt;-<span class="st"> </span><span class="kw">as</span>(zuni, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># Correspondance analysis of the whole dataset</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">corresp &lt;-<span class="st"> </span>ca<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ca/man/ca.html">ca</a></span>(zuni_counts)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">coords &lt;-<span class="st"> </span>ca<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ca/man/cacoord.html">cacoord</a></span>(corresp, <span class="dt">type =</span> <span class="st">"principal"</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co"># Plot CA results</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> Dim1, <span class="dt">y =</span> Dim2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(coords<span class="op">$</span>rows), <span class="dt">color =</span> <span class="st">"black"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(coords<span class="op">$</span>columns), <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</a></code></pre></div>
<p><img src="seriation_files/figure-html/ca-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Get row permutations from CA coordinates</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">zuni_indices &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate_correspondance</a></span>(zuni_counts, <span class="dt">margin =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># Permute data matrix</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">zuni_seriation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(zuni_counts, zuni_indices)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># Plot Ford diagram</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co"># Warning: this may take a few seconds!</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw"><a href="../reference/plot_bar.html">plot_ford</a></span>(zuni_seriation) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span>ggplot2<span class="op">::</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">                  <span class="dt">axis.ticks =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">                  <span class="dt">axis.title =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>())</a></code></pre></div>
<p><img src="seriation_files/figure-html/ca-seriation-1.png" width="672"></p>
</div>
<div id="refine-ca-based-seriation" class="section level2">
<h2 class="hasAnchor">
<a href="#refine-ca-based-seriation" class="anchor"></a>Refine CA-based seriation</h2>
<p><span class="citation">Peeples and Schachner (2012)</span> propose a procedure to identify samples that are subject to sampling error or samples that have underlying structural relationships and might be influencing the ordering along the CA space. This relies on a partial bootstrap approach to CA-based seriation where each sample is replicated <code>n</code> times. The maximum dimension length of the convex hull around the sample point cloud allows to remove samples for a given <code>cutoff</code> value.</p>
<p>According to <span class="citation">Peeples and Schachner (2012)</span>, “[this] point removal procedure [results in] a reduced dataset where the position of individuals within the CA are highly stable and which produces an ordering consistend with the assumptions of frequency seriation.”</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Reproduces Peeples and Schachner 2012 results</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">## Samples with convex hull maximum dimension length greater than the cutoff</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">## value will be marked for removal.</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">## Define cutoff as one standard deviation above the mean</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">fun &lt;-<span class="st"> </span><span class="cf">function</span>(x) { <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(x) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(x) }</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">## Get indices of samples to be kept</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">## Warning: this may take a few seconds!</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">zuni_keep &lt;-<span class="st"> </span><span class="kw"><a href="../reference/refine.html">refine</a></span>(zuni_counts, <span class="dt">cutoff =</span> fun, <span class="dt">n =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">## Plot convex hull</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">## blue: convex hull for samples; red: convex hull for types</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">### All bootstrap samples</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">group =</span> id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"rows"</span>]], </a>
<a class="sourceLine" id="cb5-20" data-line-number="20">                        <span class="dt">fill =</span> <span class="st">"blue"</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"columns"</span>]], </a>
<a class="sourceLine" id="cb5-22" data-line-number="22">                        <span class="dt">fill =</span> <span class="st">"red"</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Whole dataset"</span>, <span class="dt">x =</span> <span class="st">"Dim. 1"</span>, <span class="dt">y =</span> <span class="st">"Dim. 2"</span>)</a>
<a class="sourceLine" id="cb5-26" data-line-number="26">### Only retained samples</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">group =</span> id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="dt">data =</span> <span class="kw"><a href="../reference/subset.html">subset</a></span>(zuni_keep[[<span class="st">"rows"</span>]], </a>
<a class="sourceLine" id="cb5-31" data-line-number="31">                                      id <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(zuni_keep[[<span class="st">"keep"</span>]])),</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">                        <span class="dt">fill =</span> <span class="st">"blue"</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"columns"</span>]], </a>
<a class="sourceLine" id="cb5-34" data-line-number="34">                        <span class="dt">fill =</span> <span class="st">"red"</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Selected samples"</span>, <span class="dt">x =</span> <span class="st">"Dim. 1"</span>, <span class="dt">y =</span> <span class="st">"Dim. 2"</span>)</a></code></pre></div>
<p><img src="seriation_files/figure-html/refine-1.png" width="700"><img src="seriation_files/figure-html/refine-2.png" width="700"></p>
<p>If the results of <code>refine</code> is used as an input argument in <code>seriate</code>, a correspondance analysis is performed on the subset of <code>object</code> which matches the samples to be kept. Then excluded samples are projected onto the dimensions of the CA coordinate space using the row transition formulae. Finally, row coordinates onto the first dimension give the seriation order.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">## Get CA-based seriation order</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">(zuni_refined &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate_correspondance</a></span>(zuni_counts, zuni_keep, <span class="dt">margin =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; Permutation order for matrix seriation: </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt;    Matrix ID: 6499ecfb-cba2-47ce-8815-a582d19307d6 </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt;    Row order: 372 350 387 367 110 417 364 357 407 160 373 406 356 344 348 384 378 362 339 383... (400 more) </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt;    Column order: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;    Method: refined correspondance</span></a></code></pre></div>
</div>
</div>
<div id="dating" class="section level1">
<h1 class="hasAnchor">
<a href="#dating" class="anchor"></a>Dating</h1>
<p>This package provides an implementation of the chronological modeling method developed by <span class="citation">Bellanger and Husi (2012)</span>. This allows the construction of two different probability estimate density curves of archaeological assembalge dates. The first one (<em>event date</em>) represents the <em>terminus post-quem</em> of an archaeological assemblage: an event dated in calendar time. The second represents the “chronological profile” of the assemblage: the <em>accumulation rate</em> <span class="citation">(Bellanger and Husi 2012)</span>.</p>
<p>This method - somewhat similar to that described by <span class="citation">Poblome and Groenen (2003)</span> - is based on the adjustment of a Gaussian multiple linear regression model on the factors resulting from a correspondence analysis. This model results from the known dates of a selection of reliable contexts and allows to predict the <em>event</em> dates of the remaining assemblage with a 95% confidence interval.</p>
<p>Since correspondence analysis allows the rows and columns of a contingency table to be projected in the same space (through the transition formula), it is possible to estimate the date of each fabric using the previous model. Finally, the <em>accumulation</em> date of each context is defined as the mean of the fabric dates, weighted by their relative proportions in that context <span class="citation">(akin to the <em>Mean Ceramic Date</em> proposed by South 1977)</span>.</p>
<p>This method relies on strong archaeological and statistical assumptions. Use it only if you know what you are doing. Note that this implementation is <strong>experimental</strong> (see <code><a href="https://rdrr.io/r/utils/help.html">help(dateEvent)</a></code>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Coerce dataset to abundance (count) matrix</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">zuni &lt;-<span class="st"> </span><span class="kw">as</span>(zuni, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Assume that some assemblages are reliably dated (this is NOT a real example).</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co"># The names of the vector entries must match the names of the assemblages.</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw">set_dates</span>(zuni) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  <span class="dt">LZ0569 =</span> <span class="dv">1097</span>, <span class="dt">LZ0279 =</span> <span class="dv">1119</span>, <span class="dt">CS16 =</span> <span class="dv">1328</span>, <span class="dt">LZ0066 =</span> <span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  <span class="dt">LZ0852 =</span> <span class="dv">1216</span>, <span class="dt">LZ1209 =</span> <span class="dv">1251</span>, <span class="dt">CS144 =</span> <span class="dv">1262</span>, <span class="dt">LZ0563 =</span> <span class="dv">1206</span>,</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  <span class="dt">LZ0329 =</span> <span class="dv">1076</span>, <span class="dt">LZ0005Q =</span> <span class="dv">859</span>, <span class="dt">LZ0322 =</span> <span class="dv">1109</span>, <span class="dt">LZ0067 =</span> <span class="dv">863</span>,</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">  <span class="dt">LZ0578 =</span> <span class="dv">1180</span>, <span class="dt">LZ0227 =</span> <span class="dv">1104</span>, <span class="dt">LZ0610 =</span> <span class="dv">1074</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co"># Model the event and accumulation date for each assemblage.</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14">(model &lt;-<span class="st"> </span><span class="kw"><a href="../reference/date.html">date_event</a></span>(zuni, <span class="dt">cutoff =</span> <span class="dv">90</span>))</a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; Modelled event date:</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; - Residual standard error: 3.67</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; - Multiple R-squared: 0.99972</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; - Adjusted R-squared: 0.99921</span></a></code></pre></div>
<p>The estimated probability density of an event date is approached by a normal distribution. The distribution of the accumulation time of each context is approached by a Gaussian mixture.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Plot event (line) and accumulation (grey area) date distributions</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="../reference/plot_date.html">plot_date</a></span>(model, <span class="dt">select =</span> <span class="st">"LZ1105"</span>, <span class="dt">event =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</a></code></pre></div>
<p><img src="seriation_files/figure-html/plot-date-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Resampling methods can be used to check the stability of the resulting model. If <code>jackknife</code> is <code>TRUE</code>, one type/fabric is removed at a time and all statistics are recalculated. In this way, one can assess whether certain type/fabric has a substantial influence on the date estimate. If <code>bootstrap</code> is <code>TRUE</code>, a large number of new bootstrap assemblages is created, with the same sample size, by resampling the original assemblage with replacement. Then, examination of the bootstrap statistics makes it possible to pinpoint assemblages that require further investigation.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Check model variability</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">## Jackknife fabrics</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">refined_jack &lt;-<span class="st"> </span><span class="kw"><a href="../reference/refine.html">refine</a></span>(model, <span class="dt">method =</span> <span class="st">"jackknife"</span>, <span class="dt">n =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(refined_jack)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;            id      date     lower     upper    error      bias</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; LZ1105 LZ1105 1174.5409 1164.8082 1184.2737 3.786202 111.73783</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; LZ1103 LZ1103 1144.9000 1141.1997 1148.6003 1.439488  35.12667</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; LZ1100 LZ1100 1161.1516 1153.1079 1169.1952 3.129114  93.13122</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; LZ1099 LZ1099 1105.5047 1098.3851 1112.6243 2.769655 105.94780</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; LZ1097 LZ1097 1098.4621 1089.9623 1106.9619 3.306570 171.80558</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; LZ1096 LZ1096  850.5604  840.4834  860.6374 3.920110 191.16341</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"></a>
<a class="sourceLine" id="cb9-13" data-line-number="13">## Bootstrap of assemblages</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">refined_boot &lt;-<span class="st"> </span><span class="kw"><a href="../reference/refine.html">refine</a></span>(model, <span class="dt">method =</span> <span class="st">"bootstrap"</span>, <span class="dt">n =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(refined_boot)</a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt;       id       min       Q05      mean       Q95      max</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; 1 LZ1105 1110.5901 1140.3476 1168.5828 1195.6956 1221.696</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; 2 LZ1103 1046.5106 1094.2006 1141.1813 1180.5902 1218.170</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; 3 LZ1100 1061.6247 1102.9261 1155.1005 1200.9895 1234.376</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; 4 LZ1099 1088.9400 1090.8833 1099.4353 1107.7959 1118.772</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; 5 LZ1097  884.4105  997.5937 1087.4527 1171.7002 1214.822</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; 6 LZ1096  725.8462  725.8462  840.2232  952.7848 1066.254</span></a></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-bellanger2012">
<p>Bellanger, Lise, and Philippe Husi. 2012. “Statistical Tool for Dating and Interpreting Archaeological Contexts Using Pottery.” <em>Journal of Archaeological Science</em> 39 (4): 777–90. <a href="https://doi.org/10.1016/j.jas.2011.06.031" class="uri">https://doi.org/10.1016/j.jas.2011.06.031</a>.</p>
</div>
<div id="ref-dunnell1970">
<p>Dunnell, Robert C. 1970. “Seriation Method and Its Evaluation.” <em>American Antiquity</em> 35 (03): 305–19. <a href="https://doi.org/10.2307/278341" class="uri">https://doi.org/10.2307/278341</a>.</p>
</div>
<div id="ref-ihm2005">
<p>Ihm, Peter. 2005. “A Contribution to the History of Seriation in Archaeology.” In <em>Classification the Ubiquitous Challenge</em>, edited by Claus Weihs and Wolfgang Gaul, 307–16. Berlin Heidelberg: Springer. <a href="https://doi.org/10.1007/3-540-28084-7_34" class="uri">https://doi.org/10.1007/3-540-28084-7_34</a>.</p>
</div>
<div id="ref-peeples2012">
<p>Peeples, Matthew A., and Gregson Schachner. 2012. “Refining Correspondence Analysis-Based Ceramic Seriation of Regional Data Sets.” <em>Journal of Archaeological Science</em> 39 (8): 2818–27. <a href="https://doi.org/10.1016/j.jas.2012.04.040" class="uri">https://doi.org/10.1016/j.jas.2012.04.040</a>.</p>
</div>
<div id="ref-poblome2003">
<p>Poblome, J., and P. J. F. Groenen. 2003. “Constrained Correspondence Analysis for Seriation of Sagalassos Tablewares.” In <em>The Digital Heritage of Archaeology</em>, edited by M. Doerr and A. Sarris. Athens: Hellenic Ministry of Culture.</p>
</div>
<div id="ref-south1977">
<p>South, S. A. 1977. <em>Method and Theory in Historical Archaeology</em>. Studies in Archeology. New York: Academic Press.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#seriation">Seriation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#reciprocal-ranking">Reciprocal ranking</a></li>
      <li><a href="#reciprocal-averaging">Reciprocal averaging</a></li>
      <li><a href="#correspondance-analysis">Correspondance analysis</a></li>
      <li><a href="#refine-ca-based-seriation">Refine CA-based seriation</a></li>
      </ul>
</li>
      <li><a href="#dating">Dating</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicolas Frerebeau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
