<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tabula • tabula</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tabula">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tabula.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/diversity.html">Diversity measures</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nfrerebeau/tabula">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>tabula</h1>
                        <h4 class="author">N. Frerebeau</h4>
            
            <h4 class="date">2019-04-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nfrerebeau/tabula/blob/master/vignettes/tabula.Rmd"><code>vignettes/tabula.Rmd</code></a></small>
      <div class="hidden name"><code>tabula.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p><code>tabula</code> provides an easy way to examine archaeological count data (artifacts, faunal remains, etc.). This package includes several measures of diversity: e.g. richness and rarefaction (Chao1, Chao2, ACE, ICE, etc.), diversity/dominance and evenness (Brillouin, Shannon, Simpson, etc.), turnover and similarity (Brainerd-Robinson, …). It also provides matrix seriation methods (reciprocal ranking, CA-based seriation) for chronological modeling and dating. The package make it easy to visualize count data and statistical thresholds: rank/abundance plots, Ford and Bertin diagrams, etc.</p>
</div>
<div id="data-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#data-matrix" class="anchor"></a>Data matrix</h2>
<p><code>tabula</code> provides a set of S4 classes that extend the <code>matrix</code> data type from R <code>base</code>. These new classes represent different special types of matrix.</p>
<ul>
<li>Abundance matrix:
<ul>
<li>
<code>CountMatrix</code> represents count data,</li>
<li>
<code>FrequencyMatrix</code> represents frequency data.</li>
</ul>
</li>
<li>Logical matrix:
<ul>
<li>
<code>IncidenceMatrix</code> represents presence/absence data.</li>
</ul>
</li>
<li>Numeric matrix:
<ul>
<li>
<code>OccurrenceMatrix</code> represents a co-occurence matrix.</li>
<li>
<code>SimilarityMatrix</code> represents a (dis)similarity matrix.</li>
</ul>
</li>
</ul>
<p>It assumes that you keep your data tidy: each variable (taxon/type) must be saved in its own column and each observation (sample/case) must be saved in its own row. Missing values are not allowed.</p>
<div id="definitions" class="section level3">
<h3 class="hasAnchor">
<a href="#definitions" class="anchor"></a>Definitions</h3>
<div id="abundance-matix" class="section level4">
<h4 class="hasAnchor">
<a href="#abundance-matix" class="anchor"></a>Abundance matix</h4>
<div id="count-matrix" class="section level5">
<h5 class="hasAnchor">
<a href="#count-matrix" class="anchor"></a>Count matrix</h5>
<p>We denote the <span class="math inline">\(m \times p\)</span> count matrix by <span class="math inline">\(A = \left[ a_{ij} \right] ~\forall i \in \left[ 1,m \right], j \in \left[ 1,p \right]\)</span> with row and column sums:</p>
<p><span class="math display">\[\begin{align}
 a_{i \cdot} = \sum_{j = 1}^{p} a_{ij} &amp;&amp;
 a_{\cdot j} = \sum_{i = 1}^{m} a_{ij} &amp;&amp;
 a_{\cdot \cdot} = \sum_{i = 1}^{m} \sum_{j = 1}^{p} a_{ij} &amp;&amp;
 \forall a_{ij} \in \mathbb{N}
\end{align}\]</span></p>
</div>
<div id="frequency-matrix" class="section level5">
<h5 class="hasAnchor">
<a href="#frequency-matrix" class="anchor"></a>Frequency matrix</h5>
<p>A frequency matrix represents relative abundances.</p>
<p>We denote the <span class="math inline">\(m \times p\)</span> frequency matrix by <span class="math inline">\(B = \left[ b_{ij} \right] ~\forall i \in \left[ 1,m \right], j \in \left[ 1,p \right]\)</span> with row and column sums:</p>
<p><span class="math display">\[\begin{align}
 b_{i \cdot} = \sum_{j = 1}^{p} b_{ij} = 1 &amp;&amp;
 b_{\cdot j} = \sum_{i = 1}^{m} b_{ij} &amp;&amp;
 b_{\cdot \cdot} = \sum_{i = 1}^{m} \sum_{j = 1}^{p} b_{ij} &amp;&amp;
 \forall b_{ij} \in \left[ 0,1 \right]
\end{align}\]</span></p>
</div>
</div>
<div id="logical-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#logical-matrix" class="anchor"></a>Logical matrix</h4>
<div id="incidence-matrix" class="section level5">
<h5 class="hasAnchor">
<a href="#incidence-matrix" class="anchor"></a>Incidence matrix</h5>
<p>We denote the <span class="math inline">\(m \times p\)</span> incidence matrix by <span class="math inline">\(C = \left[ c_{ij} \right] ~\forall i \in \left[ 1,m \right], j \in \left[ 1,p \right]\)</span> with row and column sums:</p>
<p><span class="math display">\[\begin{align}
 c_{i \cdot} = \sum_{j = 1}^{p} c_{ij} &amp;&amp;
 c_{\cdot j} = \sum_{i = 1}^{m} c_{ij} &amp;&amp;
 c_{\cdot \cdot} = \sum_{i = 1}^{m} \sum_{j = 1}^{p} c_{ij} &amp;&amp;
 \forall c_{ij} \in \lbrace 0,1 \rbrace
\end{align}\]</span></p>
</div>
</div>
<div id="numeric-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#numeric-matrix" class="anchor"></a>Numeric matrix</h4>
<div id="co-occurrence-matrix" class="section level5">
<h5 class="hasAnchor">
<a href="#co-occurrence-matrix" class="anchor"></a>Co-occurrence matrix</h5>
<p>A co-occurrence matrix is a symetric matrix with zeros on its main diagonal, which works out how many times (expressed in percent) each pairs of taxa occur together in at least one sample.</p>
<p>The <span class="math inline">\(p \times p\)</span> co-occurrence matrix <span class="math inline">\(D = \left[ d_{i,j} \right] ~\forall i,j \in \left[ 1,p \right]\)</span> is defined over an <span class="math inline">\(m \times p\)</span> abundance matrix <span class="math inline">\(A = \left[ a_{x,y} \right] ~\forall x \in \left[ 1,m \right], y \in \left[ 1,p \right]\)</span> as:</p>
<p><span class="math display">\[ d_{i,j} = \sum_{x = 1}^{m} \bigcap_{y = i}^{j} a_{xy} \]</span></p>
<p>with row and column sums:</p>
<p><span class="math display">\[\begin{align}
  d_{i \cdot} = \sum_{j \geqslant i}^{p} d_{ij} &amp;&amp;
  d_{\cdot j} = \sum_{i \leqslant j}^{p} d_{ij} &amp;&amp;
  d_{\cdot \cdot} = \sum_{i = 1}^{p} \sum_{j \geqslant i}^{p} d_{ij} &amp;&amp;
  \forall d_{ij} \in \mathbb{N}
\end{align}\]</span></p>
</div>
</div>
</div>
<div id="usage" class="section level3">
<h3 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h3>
<div id="create" class="section level4">
<h4 class="hasAnchor">
<a href="#create" class="anchor"></a>Create</h4>
<p>These new classes are of simple use, on the same way as the base <code>matrix</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Create a count data matrix</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="../reference/CountMatrix-class.html">CountMatrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">100</span>, <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">            <span class="dt">nrow =</span> <span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; 10 x 10 count data matrix: </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;    V1 V2 V3 V4 V5 V6 V7 V8 V9 V10</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; 1   2  5  7  6 10  9  1  7 10   3</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; 2   5 10 10  8  5  8  1  9  6   3</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; 3   5  0  3  0  8  3  0  2  1   5</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; 4   9  0  0  7  6  4  1  1  5   3</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; 5   8  1  0  3  9  9  6  9  5   4</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; 6   4  6 10  6  4  9  2  0  7  10</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; 7   1  0 10  4  8  5  4  7  7   0</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; 8   8  5  0  5  1 10  1  2 10   2</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; 9   3 10  1  4  5 10  8  2  7   0</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; 10  6  8  6  9  7  0  2  4  7   8</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co"># Create an incidence (presence/absence) matrix</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co"># Numeric values are coerced to logical as by as.logical</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw"><a href="../reference/IncidenceMatrix-class.html">IncidenceMatrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">100</span>, <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">                <span class="dt">nrow =</span> <span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; 10 x 10 presence/absence data matrix: </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;       V1    V2    V3    V4    V5    V6    V7    V8    V9   V10</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt; 1   TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; 2  FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; 3   TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt; 4   TRUE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE FALSE</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt; 5   TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt; 6  FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt; 7  FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; 8  FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co">#&gt; 9   TRUE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co">#&gt; 10  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE</span></a></code></pre></div>
<p>Note that a <code>FrequencyMatrix</code> can only be created by coercion from a <code>CountMatrix</code> to ensure data integrity (see below).</p>
</div>
<div id="coerce" class="section level4">
<h4 class="hasAnchor">
<a href="#coerce" class="anchor"></a>Coerce</h4>
<p><code>tabula</code> uses coercing mechanisms (with validation methods) for data type conversions:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Create a count matrix</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#  Numeric values are coerced to integer and hence truncated towards zero</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">A1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CountMatrix-class.html">CountMatrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">100</span>, <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                  <span class="dt">nrow =</span> <span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># Coerce counts to frequencies</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">B &lt;-<span class="st"> </span><span class="kw">as</span>(A1, <span class="st">"FrequencyMatrix"</span>)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co"># Row sums are internally stored before coercing to a frequency matrix</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="kw"><a href="../reference/accessors.html">totals</a></span>(B)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; 51 46 52 43 50 58 59 57 54 74</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co"># This allows to restore the source data</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">A2 &lt;-<span class="st"> </span><span class="kw">as</span>(B, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all">all</a></span>(A1 <span class="op">==</span><span class="st"> </span>A2)</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co"># Coerce to presence/absence</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">C &lt;-<span class="st"> </span><span class="kw">as</span>(A1, <span class="st">"IncidenceMatrix"</span>)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co"># Coerce to a co-occurrence matrix</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22">D &lt;-<span class="st"> </span><span class="kw">as</span>(A1, <span class="st">"OccurrenceMatrix"</span>)</a></code></pre></div>
</div>
</div>
<div id="visualization" class="section level3">
<h3 class="hasAnchor">
<a href="#visualization" class="anchor"></a>Visualization</h3>
<p>Several types of graphs are available in <code>tabula</code> which uses <code>ggplot2</code> for plotting informations. This makes it easy to customize diagramms (e.g. using themes and scales).</p>
<div id="spot-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#spot-plot" class="anchor"></a>Spot plot</h4>
<p>Spot matrix allows direct examination of data (above/below some threshold):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Plot frequencies with the column means as a threshold</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">mississippi_counts &lt;-<span class="st"> </span><span class="kw">as</span>(mississippi, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="../reference/plotSpot-method.html">plotSpot</a></span>(mississippi_counts, <span class="dt">threshold =</span> mean) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">size =</span> <span class="st">"Frequency"</span>, <span class="dt">colour =</span> <span class="st">"Mean"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span>khroma<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/khroma/topics/scale_tol_discrete">scale_colour_vibrant</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-freq-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Plot co-occurence of types</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># (i.e. how many times (percent) each pairs of taxa occur together </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># in at least one sample.)</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">mississippi_occ &lt;-<span class="st"> </span><span class="kw">as</span>(mississippi, <span class="st">"OccurrenceMatrix"</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw"><a href="../reference/plotSpot-method.html">plotSpot</a></span>(mississippi_occ) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">size =</span> <span class="st">""</span>, <span class="dt">colour =</span> <span class="st">"Co-occurrence"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.box =</span> <span class="st">"horizontal"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span>khroma<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/khroma/topics/scale_tol_sequential">scale_colour_YlOrBr</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-occ-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="matrix-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#matrix-plot" class="anchor"></a>Matrix plot</h4>
<p>Abundance matrix can be displayed as a heatmap of relative abundances (frequency), or as percentages of the independence value (in french, “pourcentages de valeur d’indépendance”, PVI).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Reproduce B. Desachy's matrigraphe</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">boves_counts &lt;-<span class="st"> </span><span class="kw">as</span>(boves, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="../reference/plotMatrix-method.html">plotMatrix</a></span>(boves_counts) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_light</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="st">  </span>khroma<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/khroma/topics/scale_tol_sequential">scale_fill_YlOrBr</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-matrix-1.png" width="672" style="display: block; margin: auto;"></p>
<p>PVI is calculated for each cell as the percentage to the column theoretical independence value: PVI greater than <span class="math inline">\(1\)</span> represent positive deviations from the independance, whereas PVI smaller than <span class="math inline">\(1\)</span> represent negative deviations <span class="citation">(Desachy 2004)</span>. The PVI matrix allows to explore deviations from independence (an intuitive graphical approach to <span class="math inline">\(\chi^2\)</span>), in such a way that a high-contrast matrix has quite significant deviations, with a low risk of being due to randomness <span class="citation">(Desachy 2004)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Reproduce B. Desachy's matrigraphe</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="../reference/plotMatrix-method.html">plotMatrix</a></span>(boves_counts, <span class="dt">PVI =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_gradient">scale_fill_gradient2</a></span>(<span class="dt">midpoint =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-matrigraphe-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="bar-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#bar-plot" class="anchor"></a>Bar plot</h4>
<p>Bertin or Ford (battleship curve) diagramms can also be plotted, with statistic threshold.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/plotBar-method.html">plotBar</a></span>(boves_counts, <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Ford diagram"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-bertin-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/plotBar-method.html">plotBar</a></span>(boves_counts, <span class="dt">center =</span> <span class="ot">TRUE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Bertin diagram"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_light</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-ford-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The positive difference from the column mean percentage (in french “écart positif au pourcentage moyen”, EPPM) represents a deviation from the situation of statistical independence <span class="citation">(Desachy 2004)</span>. As independence can be interpreted as the absence of relationships between types and the chronological order of the assemblages, EPPM is a usefull graphical tool to explore significance of relationship between rows and columns related to seriation <span class="citation">(Desachy 2004)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Reproduce B. Desachy's sériographe</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="../reference/plotBar-method.html">plotBar</a></span>(boves_counts, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span>khroma<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/khroma/topics/scale_tol_discrete">scale_fill_bright</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-seriographe-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="seriation" class="section level2">
<h2 class="hasAnchor">
<a href="#seriation" class="anchor"></a>Seriation</h2>
<p>The matrix seriation problem in archaeology is based on three conditions and two assumptions, which <span class="citation">Dunnell (1970)</span> summarizes as follows.</p>
<p>The homogeneity conditions state that all the groups included in a seriation must:</p>
<ul>
<li>Be of comparable duration,</li>
<li>Belong to the same cultural tradition,</li>
<li>Come from the same local area.</li>
</ul>
<p>The mathematical assumptions state that the distribution of any historical or temporal class:</p>
<ul>
<li>Is continuous through time,</li>
<li>Exhibits the form of a unimodal curve.</li>
</ul>
<p>Theses assumptions create a distributional model and ordering is accomplished by arranging the matrix so that the class distributions approximate the required pattern. The resulting order is infered to be chronological.</p>
<div id="reciprocal-ranking" class="section level3">
<h3 class="hasAnchor">
<a href="#reciprocal-ranking" class="anchor"></a>Reciprocal ranking</h3>
<p>Reciprocal ranking iteratively rearrange rows and/or columns according to their weighted rank in the data matrix until convergence <span class="citation">(Ihm 2005)</span>.</p>
<p>For a given incidence matrix <span class="math inline">\(C\)</span>:</p>
<ul>
<li>The rows of <span class="math inline">\(C\)</span> are rearranged in increasing order of:</li>
</ul>
<p><span class="math display">\[ x_{i} = \sum_{j = 1}^{p} j \frac{c_{ij}}{c_{i \cdot}} \]</span></p>
<ul>
<li>The columns of <span class="math inline">\(C\)</span> are rearranged in a similar way:</li>
</ul>
<p><span class="math display">\[ y_{j} = \sum_{i = 1}^{m} i \frac{c_{ij}}{c_{\cdot j}} \]</span></p>
<p>These two steps are repeated until convergence. Note that this procedure could enter into an infinite loop.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Build an incidence matrix with random data</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">incidence1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/IncidenceMatrix-class.html">IncidenceMatrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">400</span>, <span class="ot">TRUE</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)),</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                              <span class="dt">nrow =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co"># Get seriation order on rows and columns</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co"># If no convergence is reached before the maximum number of iterations (100), </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co"># it stops with a warning.</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">(indices &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate</a></span>(incidence1, <span class="dt">method =</span> <span class="st">"reciprocal"</span>, <span class="dt">margin =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">                    <span class="dt">stop =</span> <span class="dv">100</span>))</a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; Permutation order for matrix seriation: </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;    Row order: 1 4 20 3 9 16 19 10 13 2 11 7 17 5 6 18 14 15 8 12 </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;    Column order: 1 16 9 4 8 14 3 20 13 2 6 18 7 17 5 11 19 12 15 10 </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;    Method: reciprocal</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co"># Permute matrix rows and columns</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17">incidence2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(incidence1, indices)</a>
<a class="sourceLine" id="cb10-18" data-line-number="18"></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co"># Plot matrix</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="kw"><a href="../reference/plotMatrix-method.html">plotMatrix</a></span>(incidence1) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Original matrix"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_manual">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TRUE"</span> =<span class="st"> "black"</span>, <span class="st">"FALSE"</span> =<span class="st"> "white"</span>))</a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="kw"><a href="../reference/plotMatrix-method.html">plotMatrix</a></span>(incidence2) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Rearranged matrix"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_manual">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TRUE"</span> =<span class="st"> "black"</span>, <span class="st">"FALSE"</span> =<span class="st"> "white"</span>))</a></code></pre></div>
<p><img src="tabula_files/figure-html/ranking-1.png" width="700"><img src="tabula_files/figure-html/ranking-2.png" width="700"></p>
</div>
<div id="reciprocal-averaging" class="section level3">
<h3 class="hasAnchor">
<a href="#reciprocal-averaging" class="anchor"></a>Reciprocal averaging</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Reproduces Desachy 2004 results</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">## Coerce dataset to an abundance matrix</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">compiegne_counts &lt;-<span class="st"> </span><span class="kw">as</span>(compiegne, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">## Plot original data matrix</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="kw"><a href="../reference/plotBar-method.html">plotBar</a></span>(compiegne_counts, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Original dataset"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">panel.spacing =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/reexports">unit</a></span>(<span class="dv">0</span>, <span class="st">"lines"</span>),</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">                 <span class="dt">panel.border =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_rect</a></span>(<span class="dt">colour =</span> <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">                 <span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">## Get seriation order for columns on EPPM using the reciprocal averaging method</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">## Expected column order: N, A, C, K, P, L, B, E, I, M, D, G, O, J, F, H</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">compiegne_indices &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate</a></span>(compiegne_counts, <span class="dt">method =</span> <span class="st">"reciprocal"</span>, </a>
<a class="sourceLine" id="cb11-17" data-line-number="17">                             <span class="dt">EPPM =</span> <span class="ot">TRUE</span>, <span class="dt">margin =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-18" data-line-number="18"></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">## Permute columns</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20">compiegne_seriation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(compiegne_counts, compiegne_indices)</a>
<a class="sourceLine" id="cb11-21" data-line-number="21"></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">## Plot new matrix</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="kw"><a href="../reference/plotBar-method.html">plotBar</a></span>(compiegne_seriation, <span class="dt">EPPM =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Reordered dataset"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">panel.spacing =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/reexports">unit</a></span>(<span class="dv">0</span>, <span class="st">"lines"</span>),</a>
<a class="sourceLine" id="cb11-27" data-line-number="27">                 <span class="dt">panel.border =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_rect</a></span>(<span class="dt">colour =</span> <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb11-28" data-line-number="28">                 <span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="tabula_files/figure-html/averaging-1.png" width="672"><img src="tabula_files/figure-html/averaging-2.png" width="672"></p>
</div>
<div id="correspondance-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#correspondance-analysis" class="anchor"></a>Correspondance analysis</h3>
<p>Correspondance Analysis (CA) is an effective method for the seriation of archaeological assemblages. The order of the rows and columns is given by the coordinates along one dimension of the CA space, assumed to account for temporal variation. The direction of temporal change within the correspondance analysis space is arbitrary: additional information is needed to determine the actual order in time.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">## Coerce dataset to an abundance matrix</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">zuni_counts &lt;-<span class="st"> </span><span class="kw">as</span>(zuni, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># Correspondance analysis of the whole dataset</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">ca &lt;-<span class="st"> </span>FactoMineR<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/FactoMineR/topics/CA">CA</a></span>(zuni_counts, <span class="dt">graph =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co"># Plot CA results</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Dim 1</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">Dim 2</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(ca<span class="op">$</span>row<span class="op">$</span>coord), <span class="dt">color =</span> <span class="st">"black"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(ca<span class="op">$</span>col<span class="op">$</span>coord), <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/coord_fixed">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/ca-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Get row permutations from CA coordinates</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">zuni_indices &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate</a></span>(zuni_counts, <span class="dt">method =</span> <span class="st">"correspondance"</span>, <span class="dt">margin =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co"># Permute data matrix</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">zuni_seriation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">permute</a></span>(zuni_counts, zuni_indices)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co"># Plot Ford diagram</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co"># Warning: this may take a few seconds!</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw"><a href="../reference/plotBar-method.html">plotBar</a></span>(zuni_seriation, <span class="dt">level =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="st">  </span>ggplot2<span class="op">::</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">                  <span class="dt">axis.ticks =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">                  <span class="dt">axis.title =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_blank</a></span>())</a></code></pre></div>
<p><img src="tabula_files/figure-html/ca-seriation-1.png" width="672"></p>
</div>
<div id="refine-ca-based-seriation" class="section level3">
<h3 class="hasAnchor">
<a href="#refine-ca-based-seriation" class="anchor"></a>Refine CA-based seriation</h3>
<p><span class="citation">Peeples and Schachner (2012)</span> propose a procedure to identify samples that are subject to sampling error or samples that have underlying structural relationships and might be influencing the ordering along the CA space. This relies on a partial bootstrap approach to CA-based seriation where each sample is replicated <code>n</code> times. The maximum dimension length of the convex hull around the sample point cloud allows to remove samples for a given <code>cutoff</code> value.</p>
<p>According to <span class="citation">Peeples and Schachner (2012)</span>, “[this] point removal procedure [results in] a reduced dataset where the position of individuals within the CA are highly stable and which produces an ordering consistend with the assumptions of frequency seriation.”</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Reproduces Peeples and Schachner 2012 results</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">## Samples with convex hull maximum dimension length greater than the cutoff</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">## value will be marked for removal.</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">## Define cutoff as one standard deviation above the mean</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">fun &lt;-<span class="st"> </span><span class="cf">function</span>(x) { <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(x) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(x) }</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">## Get indices of samples to be kept</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">## Warning: this may take a few seconds!</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">zuni_keep &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">refine</a></span>(zuni_counts, <span class="dt">cutoff =</span> fun, <span class="dt">n =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb14-12" data-line-number="12"></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">## Plot convex hull</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">## blue: convex hull for samples; red: convex hull for types</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">### All bootstrap samples</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16">ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">group =</span> id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_polygon">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"rows"</span>]], </a>
<a class="sourceLine" id="cb14-20" data-line-number="20">                        <span class="dt">fill =</span> <span class="st">"blue"</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_polygon">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"columns"</span>]], </a>
<a class="sourceLine" id="cb14-22" data-line-number="22">                        <span class="dt">fill =</span> <span class="st">"red"</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/coord_fixed">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Whole dataset"</span>, <span class="dt">x =</span> <span class="st">"Dim. 1"</span>, <span class="dt">y =</span> <span class="st">"Dim. 2"</span>)</a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">### Only retained samples</span></a>
<a class="sourceLine" id="cb14-27" data-line-number="27">ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">group =</span> id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_polygon">geom_polygon</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/subset">subset</a></span>(zuni_keep[[<span class="st">"rows"</span>]], </a>
<a class="sourceLine" id="cb14-31" data-line-number="31">                                      id <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(zuni_keep[[<span class="st">"keep"</span>]])),</a>
<a class="sourceLine" id="cb14-32" data-line-number="32">                        <span class="dt">fill =</span> <span class="st">"blue"</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_polygon">geom_polygon</a></span>(<span class="dt">data =</span> zuni_keep[[<span class="st">"columns"</span>]], </a>
<a class="sourceLine" id="cb14-34" data-line-number="34">                        <span class="dt">fill =</span> <span class="st">"red"</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-35" data-line-number="35"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/coord_fixed">coord_fixed</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-36" data-line-number="36"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Selected samples"</span>, <span class="dt">x =</span> <span class="st">"Dim. 1"</span>, <span class="dt">y =</span> <span class="st">"Dim. 2"</span>)</a></code></pre></div>
<p><img src="tabula_files/figure-html/refine-1.png" width="700"><img src="tabula_files/figure-html/refine-2.png" width="700"></p>
<p>If the results of <code>refine</code> is used as an input argument in <code>seriate</code>, a correspondance analysis is performed on the subset of <code>object</code> which matches the samples to be kept. Then excluded samples are projected onto the dimensions of the CA coordinate space using the row transition formulae. Finally, row coordinates onto the first dimension give the seriation order.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">## Get CA-based seriation order</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">(zuni_refined &lt;-<span class="st"> </span><span class="kw"><a href="../reference/seriation.html">seriate</a></span>(zuni_counts, zuni_keep, <span class="dt">margin =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt; Permutation order for matrix seriation: </span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt;    Row order: 372 350 387 367 110 417 364 357 407 406 160 344 348 356 373 384 378 362 339 383... (400 more) </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt;    Column order: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 </span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt;    Method: refined correspondance</span></a></code></pre></div>
</div>
</div>
<div id="dating" class="section level2">
<h2 class="hasAnchor">
<a href="#dating" class="anchor"></a>Dating</h2>
<p>This package provides an implementation of the chronological modeling method developed by <span class="citation">Bellanger and Husi (2012)</span>. This allows the construction of two different probability estimate density curves of archaeological assembalge dates. The first one (<em>event date</em>) represents the <em>terminus post-quem</em> of an archaeological assemblage: an event dated in calendar time. The second represents the “chronological profile” of the assemblage: the <em>accumulation rate</em> <span class="citation">(Bellanger and Husi 2012)</span>.</p>
<p>This method - somewhat similar to that described by <span class="citation">Poblome and Groenen (2003)</span> - is based on the adjustment of a Gaussian multiple linear regression model on the factors resulting from a correspondence analysis. This model results from the known dates of a selection of reliable contexts and allows to predict the <em>event</em> dates of the remaining assemblage with a 95% confidence interval.</p>
<p>Since correspondence analysis allows the rows and columns of a contingency table to be projected in the same space (through the transition formula), it is possible to estimate the date of each fabric using the previous model. Finally, the <em>accumulation</em> date of each context is defined as the mean of the fabric dates, weighted by their relative proportions in that context (akin to the <em>Mean Ceramic Date</em> proposed by <span class="citation">South (1977)</span>).</p>
<p>This method relies on strong archaeological and statistical assumptions. Use it only if you know what you are doing. Note that this implementation is <strong>experimental</strong> (see <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(dateEvent)</a></code>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Coerce dataset to abundance (count) matrix</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">zuni &lt;-<span class="st"> </span><span class="kw">as</span>(zuni, <span class="st">"CountMatrix"</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co"># Assume that some assemblages are reliably dated (this is NOT a real example).</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># The names of the vector entries must match the names of the assemblages.</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">dates &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">  <span class="dt">LZ0569 =</span> <span class="dv">1097</span>, <span class="dt">LZ0279 =</span> <span class="dv">1119</span>, <span class="dt">CS16 =</span> <span class="dv">1328</span>, <span class="dt">LZ0066 =</span> <span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">  <span class="dt">LZ0852 =</span> <span class="dv">1216</span>, <span class="dt">LZ1209 =</span> <span class="dv">1251</span>, <span class="dt">CS144 =</span> <span class="dv">1262</span>, <span class="dt">LZ0563 =</span> <span class="dv">1206</span>,</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">  <span class="dt">LZ0329 =</span> <span class="dv">1076</span>, <span class="dt">LZ0005Q =</span> <span class="dv">859</span>, <span class="dt">LZ0322 =</span> <span class="dv">1109</span>, <span class="dt">LZ0067 =</span> <span class="dv">863</span>,</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">  <span class="dt">LZ0578 =</span> <span class="dv">1180</span>, <span class="dt">LZ0227 =</span> <span class="dv">1104</span>, <span class="dt">LZ0610 =</span> <span class="dv">1074</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb16-12" data-line-number="12"></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co"># Model the event and accumulation date for each assemblage.</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14">(model &lt;-<span class="st"> </span><span class="kw"><a href="../reference/date.html">dateEvent</a></span>(zuni, dates, <span class="dt">cutoff =</span> <span class="dv">90</span>))</a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">#&gt; Modelled event date:</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">#&gt;    R2: 0.9997194 </span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="co">#&gt;    Residual standard deviation: 4 years</span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="co">#&gt;    CI: 95 %</span></a></code></pre></div>
<p>The estimated probability density of an event date is approached by a normal distribution. The distribution of the accumulation time of each context is approached by a Gaussian mixture.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Plot event (line) and accumulation (grey area) date distributions</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="../reference/plotDate-method.html">plotDate</a></span>(model, <span class="dt">select =</span> <span class="st">"LZ1105"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-date-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Resampling methods can be used to check the stability of the resulting model. If <code>jackknife</code> is <code>TRUE</code>, one type/fabric is removed at a time and all statistics are recalculated. In this way, one can assess whether certain type/fabric has a substantial influence on the date estimate. If <code>bootstrap</code> is <code>TRUE</code>, a large number of new bootstrap assemblages is created, with the same sample size, by resampling the original assemblage with replacement. Then, examination of the bootstrap statistics makes it possible to pinpoint assemblages that require further investigation.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Check model variability</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">checked &lt;-<span class="st"> </span><span class="kw"><a href="../reference/date.html">dateEvent</a></span>(zuni, dates, <span class="dt">cutoff =</span> <span class="dv">90</span>,</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">                     <span class="dt">jackknife =</span> <span class="ot">TRUE</span>, <span class="dt">bootstrap =</span> <span class="ot">TRUE</span>, <span class="dt">n =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co"># Extract results for the first 5 assemblages</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">## Modeled event dates</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7">checked[<span class="st">"rows"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt;       id estimation earliest   latest    error</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; 1 LZ1105   1167.968 1158.235 1177.701 3.786202</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; 2 LZ1103   1142.834 1139.133 1146.534 1.439488</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt; 3 LZ1100   1155.673 1147.630 1163.717 3.129114</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; 4 LZ1099   1099.272 1092.153 1106.392 2.769655</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; 5 LZ1097   1088.356 1079.856 1096.856 3.306570</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">## Jackknife fabrics</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15">checked[<span class="st">"jackknife"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">#&gt;       id estimation earliest   latest    error       bias</span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co">#&gt; 1 LZ1105   1174.900 1165.167 1184.632 3.786202  117.83615</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18"><span class="co">#&gt; 2 LZ1103   1145.111 1141.411 1148.812 1.439488   38.71922</span></a>
<a class="sourceLine" id="cb18-19" data-line-number="19"><span class="co">#&gt; 3 LZ1100   1159.065 1151.022 1167.109 3.129114   57.66493</span></a>
<a class="sourceLine" id="cb18-20" data-line-number="20"><span class="co">#&gt; 4 LZ1099   1089.060 1081.940 1096.180 2.769655 -173.61223</span></a>
<a class="sourceLine" id="cb18-21" data-line-number="21"><span class="co">#&gt; 5 LZ1097   1081.514 1073.014 1090.014 3.306570 -116.31049</span></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"><span class="co">## Bootstrap of assemblages</span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23">checked[<span class="st">"bootstrap"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb18-24" data-line-number="24"><span class="co">#&gt;       id       min       Q05     mean      Q95      max</span></a>
<a class="sourceLine" id="cb18-25" data-line-number="25"><span class="co">#&gt; 1 LZ1105 1110.5901 1140.3476 1168.583 1195.696 1221.696</span></a>
<a class="sourceLine" id="cb18-26" data-line-number="26"><span class="co">#&gt; 2 LZ1103 1046.5106 1094.2006 1141.181 1180.590 1218.170</span></a>
<a class="sourceLine" id="cb18-27" data-line-number="27"><span class="co">#&gt; 3 LZ1100 1061.6247 1102.9261 1155.101 1200.989 1234.376</span></a>
<a class="sourceLine" id="cb18-28" data-line-number="28"><span class="co">#&gt; 4 LZ1099 1088.9400 1090.8833 1099.435 1107.796 1118.772</span></a>
<a class="sourceLine" id="cb18-29" data-line-number="29"><span class="co">#&gt; 5 LZ1097  884.4105  997.5937 1087.453 1171.700 1214.822</span></a></code></pre></div>
</div>
<div id="analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis" class="anchor"></a>Analysis</h2>
<div id="alpha-diversity" class="section level3">
<h3 class="hasAnchor">
<a href="#alpha-diversity" class="anchor"></a><span class="math inline">\(\alpha\)</span>-diversity</h3>
<div id="richness-and-rarefaction" class="section level4">
<h4 class="hasAnchor">
<a href="#richness-and-rarefaction" class="anchor"></a>Richness and rarefaction</h4>
<p>The number of different taxa, provides an instantly comprehensible expression of diversity. While the number of taxa within a sample is easy to ascertain, as a term, it makes little sense: some taxa may not have been seen, or there may not be a fixed number of taxa (e.g. in an open system; <span class="citation">Peet (1974)</span>). As an alternative, <em>richness</em> (<span class="math inline">\(S\)</span>) can be used for the concept of taxa number <span class="citation">(McIntosh 1967)</span>.</p>
<p>It is not always possible to ensure that all sample sizes are equal and the number of different taxa increases with sample size and sampling effort (Magurran 1988). Then, <em>rarefaction</em> (<span class="math inline">\(E(S)\)</span>) is the number of taxa expected if all samples were of a standard size (i.e. taxa per fixed number of individuals). Rarefaction assumes that imbalances between taxa are due to sampling and not to differences in actual abundances. For now, only the <span class="citation">Hurlbert (1971)</span> unbiaised estimate of <span class="citation">Sander (1968)</span> rarefaction is provided.</p>
<p>The following richness measures are available for count data:</p>
<dl>
<dt><code>ace</code></dt>
<dd>Abundance-based Coverage Estimator <span class="citation">(Chao and Lee 1992)</span>.
</dd>
<dt><code>chao1</code></dt>
<dd>Chao1 estimator <span class="citation">(Chao 1984)</span>.
</dd>
<dt><code>chao1i</code></dt>
<dd>Improved Chao1 estimator <span class="citation">(Chiu et al. 2014)</span>.
</dd>
<dt><code>margalef</code></dt>
<dd>Margalef richness index <span class="citation">(Margalef 1958)</span>.
</dd>
<dt><code>menhinick</code></dt>
<dd>Menhinick richness index <span class="citation">(Menhinick 1964)</span>.
</dd>
<dt><code>none</code></dt>
<dd>Returns the number of observed taxa/types.
</dd>
</dl>
<p>The following richness measures are available for replicated incidence data:</p>
<dl>
<dt><code>ice</code></dt>
<dd>Incidence-based Coverage Estimator <span class="citation">(Chao and Chiu 2016)</span>.
</dd>
<dt><code>chao2</code></dt>
<dd>Chao2 estimator <span class="citation">(Chao 1987)</span>.
</dd>
<dt><code>chao2i</code></dt>
<dd>Improved Chao2 estimator <span class="citation">(Chiu et al. 2014)</span>.
</dd>
</dl>
</div>
<div id="diversity-and-evenness" class="section level4">
<h4 class="hasAnchor">
<a href="#diversity-and-evenness" class="anchor"></a>Diversity and evenness</h4>
<p><em>Diversity</em> can be measured according to several indices. Diversity measurement assumes that all individuals in a specific taxa are equivalent and that all types are equally different from each other <span class="citation">(Peet 1974)</span>. A measure of diversity can be achieved by using indices built on the relative abundance of taxa. These indices (sometimes referred to as non-parametric indices) benefit from not making assumptions about the underlying distribution of taxa abundance: they only take relative abundances of the species that are present and species richness into account. <span class="citation">Peet (1974)</span> refers to them as indices of <em>heterogeneity</em>. <em>Evenness</em> is a measure of how evenly individuals are distributed across the sample.</p>
<p>The following heterogeneity index (<span class="math inline">\(H\)</span>) and corresponding evenness (<span class="math inline">\(E\)</span>) measures are available (see <span class="citation">Magurran (1988)</span> for details):</p>
<dl>
<dt><code>berger</code></dt>
<dd>Berger-Parker dominance index. The Berger-Parker index expresses the proportional importance of the most abundant type. This metric is highly biased by sample size and richness, moreover it does not make use of all the information available from sample.
</dd>
<dt><code>brillouin</code></dt>
<dd>Brillouin diversity index <span class="citation">(Brillouin 1956)</span>. The Brillouin index describes a known collection: it does not assume random sampling in an infinite population. <span class="citation">Pielou (1975)</span> and <span class="citation">Laxton (1978)</span> argues for the use of the Brillouin index in all circumstances, especially in preference to the Shannon index.
</dd>
<dt><code>mcintosh</code></dt>
<dd>McIntosh dominance index <span class="citation">(McIntosh 1967)</span>. The McIntosh index expresses the heterogeneity of a sample in geometric terms. It describes the sample as a point of a <span class="math inline">\(S\)</span>-dimensional hypervolume and uses the Euclidean distance of this point from the origin.
</dd>
<dt><code>shannon</code></dt>
<dd>Shannon-Wiener diversity index <span class="citation">(Shannon 1948)</span>. The Shannon index assumes that individuals are randomly sampled from an infinite population and that all taxa are represented in the sample (it does not reflect the sample size). The main source of error arises from the failure to include all taxa in the sample: this error increases as the proportion of species discovered in the sample declines <span class="citation">(Peet 1974; Magurran 1988)</span>. The maximum likelihood estimator (MLE) is used for the relative abundance, this is known to be negatively biased by sample size.
</dd>
<dt><code>simpson</code></dt>
<dd>Simpson dominance index for finite sample <span class="citation">(Simpson 1949)</span>. The Simpson index expresses the probability that two individuals randomly picked from a finite sample belong to two different types. It can be interpreted as the weighted mean of the proportional abundances. This metric is a true probability value, it ranges from <span class="math inline">\(0\)</span> (perfectly uneven) to <span class="math inline">\(1\)</span> (perfectly even).
</dd>
</dl>
<p>Diversity indices focus on one aspect of the taxa abundance and emphasize either richness (weighting towards uncommon taxa) or dominance (weighting towards abundant taxa; <span class="citation">Magurran (1988)</span>).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">H &lt;-<span class="st"> </span><span class="kw"><a href="../reference/diversity-method.html">diversity</a></span>(</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">  mississippi_counts, </a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  <span class="dt">method =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"shannon"</span>, <span class="st">"brillouin"</span>, <span class="st">"simpson"</span>, <span class="st">"mcintosh"</span>, <span class="st">"berger"</span>), </a>
<a class="sourceLine" id="cb19-4" data-line-number="4">  <span class="dt">simplify =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(H)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt;           shannon brillouin   simpson  mcintosh    berger</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt; 10-P-1  1.2027955 1.1572676 0.3166495 0.4714431 0.4052288</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt; 11-N-9  0.7646565 0.7541207 0.5537760 0.2650711 0.6965699</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">#&gt; 11-N-1  0.9293974 0.9192403 0.5047209 0.2975381 0.6638526</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">#&gt; 11-O-10 0.8228576 0.8085445 0.5072514 0.2990830 0.6332288</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="co">#&gt; 11-N-4  0.7901428 0.7823396 0.5018826 0.2997089 0.6034755</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="co">#&gt; 13-N-5  0.9998430 0.9442803 0.3823434 0.4229570 0.4430380</span></a></code></pre></div>
<p>Note that <code>berger</code>, <code>mcintosh</code> and <code>simpson</code> methods return a <em>dominance</em> index, not the reciprocal form usually adopted, so that an increase in the value of the index accompanies a decrease in diversity.</p>
<p>Corresponding <em>evenness</em> can also be computed :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">E &lt;-<span class="st"> </span><span class="kw"><a href="../reference/diversity-method.html">evenness</a></span>(</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">  mississippi_counts,</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">  <span class="dt">method =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"brillouin"</span>, <span class="st">"mcintosh"</span>, <span class="st">"shannon"</span>, <span class="st">"simpson"</span>),</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">  <span class="dt">simplify =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb20-6" data-line-number="6"></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(E)</a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt;         brillouin  mcintosh   shannon   simpson</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; 10-P-1  0.8655943 0.8666584 0.8676335 0.7895166</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; 11-N-9  0.5491751 0.5108866 0.5515831 0.4514461</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; 11-N-1  0.5168354 0.4888798 0.5187066 0.3302155</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; 11-O-10 0.5086064 0.5196260 0.5112702 0.3942818</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt; 11-N-4  0.4894441 0.5269406 0.4909433 0.3984996</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt; 13-N-5  0.9074079 0.8881365 0.9100964 0.8718166</span></a></code></pre></div>
</div>
</div>
<div id="beta-diversity" class="section level3">
<h3 class="hasAnchor">
<a href="#beta-diversity" class="anchor"></a><span class="math inline">\(\beta\)</span>-diversity</h3>
<div id="similarity" class="section level4">
<h4 class="hasAnchor">
<a href="#similarity" class="anchor"></a>Similarity</h4>
<p><span class="math inline">\(\beta\)</span>-diversity can be measured by addressing <em>similarity</em> between pairs of samples/cases (Brainerd-Robinson, Jaccard, Morisita-Horn and Sorenson indices). Similarity bewteen pairs of taxa/types can be measured by assessing the degree of co-occurrence (binomial co-occurrence).</p>
<p>Jaccard, Morisita-Horn and Sorenson indices provide a scale of similarity from <span class="math inline">\(0\)</span>-<span class="math inline">\(1\)</span> where <span class="math inline">\(1\)</span> is perfect similarity and <span class="math inline">\(0\)</span> is no similarity.</p>
<dl>
<dt><code>binomial</code></dt>
<dd>Binomial co-occurrence assessment. This assesses the degree of co-occurrence between taxa/types within a dataset. The strongest associations are shown by large positive numbers, the strongest segregations by large negative numbers. The Binomial co-occurrence assessment approximates a Z-score.
</dd>
<dt><code>brainerd</code></dt>
<dd>Brainerd-Robinson quantitative index <span class="citation">(Brainerd 1951, <span class="citation">@robinson1951</span>)</span>. This is a city-block metric of similarity between pairs of samples/cases. The Brainerd-Robinson index is scaled between <span class="math inline">\(0\)</span> and <span class="math inline">\(200\)</span>.
</dd>
<dt><code>bray</code></dt>
<dd>Sorenson quantitative index. <span class="citation">Bray and Curtis (1957)</span> modified version of the Sorenson index.
</dd>
<dt><code>jaccard</code></dt>
<dd>Jaccard qualitative (incidence data) index.
</dd>
<dt><code>morisita</code></dt>
<dd>Morisita-Horn quantitative index.
</dd>
<dt><code>sorenson</code></dt>
<dd>Sorenson qualitative (incidence data) index.
</dd>
</dl>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Brainerd-Robinson index</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">S &lt;-<span class="st"> </span><span class="kw"><a href="../reference/similarity-method.html">similarity</a></span>(mississippi_counts, <span class="dt">method =</span> <span class="st">"brainerd"</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co"># Plot the similarity matrix</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="kw"><a href="../reference/plotSpot-method.html">plotSpot</a></span>(S) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">size =</span> <span class="st">"Similarity"</span>, <span class="dt">colour =</span> <span class="st">"Similarity"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="st">  </span>khroma<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/khroma/topics/scale_tol_sequential">scale_colour_YlOrBr</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/similarity-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="turnover" class="section level4">
<h4 class="hasAnchor">
<a href="#turnover" class="anchor"></a>Turnover</h4>
<p>The several methods can be used to acertain the degree of <em>turnover</em> in taxa composition along a gradient (<span class="math inline">\(\beta\)</span>-diversity) on qualitative (presence/absence) data. It assumes that the order of the matrix rows (from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>) follows the progression along the gradient/transect.</p>
<p>The following measures are available (see <span class="citation">Magurran (1988)</span> for details):</p>
<dl>
<dt><code>whittaker</code></dt>
<dd>Whittaker measure.
</dd>
<dt><code>cody</code></dt>
<dd>Cody measure.
</dd>
<dt><code>routledge2</code></dt>
<dd>Routledge second measure.
</dd>
<dt><code>routledge3</code></dt>
<dd>Routledge third measure. This is the exponential form of the second measure.
</dd>
<dt><code>wilson</code></dt>
<dd>Wilson measure.
</dd>
</dl>
</div>
</div>
<div id="abundance-models" class="section level3">
<h3 class="hasAnchor">
<a href="#abundance-models" class="anchor"></a>Abundance models</h3>
<p>Ranks <em>vs</em> abundance plot can be used for abundance models (model fitting will be implemented in a futur release):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="../reference/plotRank-method.html">plotRank</a></span>(compiegne_counts, <span class="dt">log =</span> <span class="st">"xy"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</a></code></pre></div>
<p><img src="tabula_files/figure-html/plot-rank-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-bellanger2012">
<p>Bellanger, Lise, and Philippe Husi. 2012. “Statistical Tool for Dating and Interpreting Archaeological Contexts Using Pottery.” <em>Journal of Archaeological Science</em> 39 (4): 777–90. <a href="https://doi.org/10.1016/j.jas.2011.06.031">https://doi.org/10.1016/j.jas.2011.06.031</a>.</p>
</div>
<div id="ref-brainerd1951">
<p>Brainerd, George W. 1951. “The Place of Chronological Ordering in Archaeological Analysis.” <em>American Antiquity</em> 16 (04): 301–13. <a href="https://doi.org/10.2307/276979">https://doi.org/10.2307/276979</a>.</p>
</div>
<div id="ref-bray1957">
<p>Bray, J. Roger, and J. T. Curtis. 1957. “An Ordination of the Upland Forest Communities of Southern Wisconsin.” <em>Ecological Monographs</em> 27 (4): 325–49. <a href="https://doi.org/10.2307/1942268">https://doi.org/10.2307/1942268</a>.</p>
</div>
<div id="ref-brillouin1956">
<p>Brillouin, Leon. 1956. <em>Science and Information Theory</em>. New York: Academic Press.</p>
</div>
<div id="ref-chao1984">
<p>Chao, Anne. 1984. “Nonparametric Estimation of the Number of Classes in a Population.” <em>Scandinavian Journal of Statistics</em> 11 (4): 265–70.</p>
</div>
<div id="ref-chao1987">
<p>———. 1987. “Estimating the Population Size for Capture-Recapture Data with Unequal Catchability.” <em>Biometrics</em> 43 (4): 783–91. <a href="https://doi.org/10.2307/2531532">https://doi.org/10.2307/2531532</a>.</p>
</div>
<div id="ref-chao2016">
<p>Chao, Anne, and Chun-Huo Chiu. 2016. “Species Richness: Estimation and Comparison.” In <em>Wiley StatsRef: Statistics Reference Online</em>, edited by N. Balakrishnan, Theodore Colton, Brian Everitt, Walter Piegorsch, Fabrizio Ruggeri, and Jozef L. Teugels, 1–26. Chichester, UK: John Wiley &amp; Sons, Ltd. <a href="https://doi.org/10.1002/9781118445112.stat03432.pub2">https://doi.org/10.1002/9781118445112.stat03432.pub2</a>.</p>
</div>
<div id="ref-chao1992">
<p>Chao, Anne, and Shen-Ming Lee. 1992. “Estimating the Number of Classes via Sample Coverage.” <em>Journal of the American Statistical Association</em> 87 (417): 210–17. <a href="https://doi.org/10.1080/01621459.1992.10475194">https://doi.org/10.1080/01621459.1992.10475194</a>.</p>
</div>
<div id="ref-chiu2014">
<p>Chiu, Chun-Huo, Yi-Ting Wang, Bruno A. Walther, and Anne Chao. 2014. “An Improved Nonparametric Lower Bound of Species Richness via a Modified Good-Turing Frequency Formula.” <em>Biometrics</em> 70 (3): 671–82. <a href="https://doi.org/10.1111/biom.12200">https://doi.org/10.1111/biom.12200</a>.</p>
</div>
<div id="ref-desachy2004">
<p>Desachy, Bruno. 2004. “Le sériographe EPPM : un outil informatisé de sériation graphique pour tableaux de comptages.” <em>Revue archéologique de Picardie</em> 3 (1): 39–56. <a href="https://doi.org/10.3406/pica.2004.2396">https://doi.org/10.3406/pica.2004.2396</a>.</p>
</div>
<div id="ref-dunnell1970">
<p>Dunnell, Robert C. 1970. “Seriation Method and Its Evaluation.” <em>American Antiquity</em> 35 (03): 305–19. <a href="https://doi.org/10.2307/278341">https://doi.org/10.2307/278341</a>.</p>
</div>
<div id="ref-hurlbert1971">
<p>Hurlbert, Stuart H. 1971. “The Nonconcept of Species Diversity: A Critique and Alternative Parameters.” <em>Ecology</em> 52 (4): 577–86. <a href="https://doi.org/10.2307/1934145">https://doi.org/10.2307/1934145</a>.</p>
</div>
<div id="ref-ihm2005">
<p>Ihm, Peter. 2005. “A Contribution to the History of Seriation in Archaeology.” In <em>Classification the Ubiquitous Challenge</em>, edited by Claus Weihs and Wolfgang Gaul, 307–16. Berlin Heidelberg: Springer. <a href="https://doi.org/10.1007/3-540-28084-7_34">https://doi.org/10.1007/3-540-28084-7_34</a>.</p>
</div>
<div id="ref-laxton1978">
<p>Laxton, R.R. 1978. “The Measure of Diversity.” <em>Journal of Theoretical Biology</em> 70 (1): 51–67. <a href="https://doi.org/10.1016/0022-5193(78)90302-8">https://doi.org/10.1016/0022-5193(78)90302-8</a>.</p>
</div>
<div id="ref-magurran1988">
<p>Magurran, Anne E. 1988. <em>Ecological Diversity and Its Measurement</em>. Princeton, NJ: Princeton University Press.</p>
</div>
<div id="ref-margalef1958">
<p>Margalef, R. 1958. “Information Theory in Ecology.” <em>General Systems</em> 3: 36–71.</p>
</div>
<div id="ref-mcintosh1967">
<p>McIntosh, Robert P. 1967. “An Index of Diversity and the Relation of Certain Concepts to Diversity.” <em>Ecology</em> 48 (3): 392–404. <a href="https://doi.org/10.2307/1932674">https://doi.org/10.2307/1932674</a>.</p>
</div>
<div id="ref-menhinick1964">
<p>Menhinick, Edward F. 1964. “A Comparison of Some Species-Individuals Diversity Indices Applied to Samples of Field Insects.” <em>Ecology</em> 45 (4): 859–61. <a href="https://doi.org/10.2307/1934933">https://doi.org/10.2307/1934933</a>.</p>
</div>
<div id="ref-peeples2012">
<p>Peeples, Matthew A., and Gregson Schachner. 2012. “Refining Correspondence Analysis-Based Ceramic Seriation of Regional Data Sets.” <em>Journal of Archaeological Science</em> 39 (8): 2818–27. <a href="https://doi.org/10.1016/j.jas.2012.04.040">https://doi.org/10.1016/j.jas.2012.04.040</a>.</p>
</div>
<div id="ref-peet1974">
<p>Peet, R K. 1974. “The Measurement of Species Diversity.” <em>Annual Review of Ecology and Systematics</em> 5 (1): 285–307. <a href="https://doi.org/10.1146/annurev.es.05.110174.001441">https://doi.org/10.1146/annurev.es.05.110174.001441</a>.</p>
</div>
<div id="ref-pielou1975">
<p>Pielou, E. C. 1975. <em>Ecological Diversity</em>. New York: Wiley.</p>
</div>
<div id="ref-poblome2003">
<p>Poblome, J., and P. J. F. Groenen. 2003. “Constrained Correspondence Analysis for Seriation of Sagalassos Tablewares.” In <em>The Digital Heritage of Archaeology</em>, edited by M. Doerr and A. Sarris. Athens: Hellenic Ministry of Culture.</p>
</div>
<div id="ref-robinson1951">
<p>Robinson, W. S. 1951. “A Method for Chronologically Ordering Archaeological Deposits.” <em>American Antiquity</em> 16 (04): 293–301. <a href="https://doi.org/10.2307/276978">https://doi.org/10.2307/276978</a>.</p>
</div>
<div id="ref-sander1968">
<p>Sander, Howard L. 1968. “Marine Benthic Diversity: A Comparative Study.” <em>The American Naturalist</em> 102 (925): 243–82. <a href="https://www.jstor.org/stable/2459027">https://www.jstor.org/stable/2459027</a>.</p>
</div>
<div id="ref-shannon1948">
<p>Shannon, C. E. 1948. “A Mathematical Theory of Communication.” <em>The Bell System Technical Journal</em> 27: 379–423. <a href="https://doi.org/10.1002/j.1538-7305.1948.tb01338.x">https://doi.org/10.1002/j.1538-7305.1948.tb01338.x</a>.</p>
</div>
<div id="ref-simpson1949">
<p>Simpson, E. H. 1949. “Measurement of Diversity.” <em>Nature</em> 163 (4148): 688–88. <a href="https://doi.org/10.1038/163688a0">https://doi.org/10.1038/163688a0</a>.</p>
</div>
<div id="ref-south1977">
<p>South, S. A. 1977. <em>Method and Theory in Historical Archaeology</em>. Studies in Archeology. New York: Academic Press.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#data-matrix">Data matrix</a></li>
      <li><a href="#seriation">Seriation</a></li>
      <li><a href="#dating">Dating</a></li>
      <li><a href="#analysis">Analysis</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nicolas Frerebeau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
